# GitHub Actions 工作流说明

本目录包含了用于自动同步上游仓库和构建项目的 GitHub Actions 工作流。

## 工作流文件

### 1. `sync-upstream.yml`
基础的上游同步工作流，每天凌晨2点自动运行。

**功能：**
- 自动同步上游仓库 `tanyaofei/minecraft-fakeplayer` 的更新
- 支持手动触发
- 自动合并上游更改

### 2. `advanced-sync.yml`
高级同步工作流，支持更多配置选项。

**功能：**
- 支持配置文件自定义同步设置
- 支持强制同步选项
- 更好的错误处理和日志记录
- 支持手动触发并选择是否强制同步

### 3. `build.yml`
构建工作流，在代码更新后自动构建项目。

**功能：**
- 自动构建 Maven 项目
- 缓存依赖包以提高构建速度
- 上传构建产物
- 自动创建发布版本

## 配置文件

### `upstream-sync.yml`
上游同步配置文件，用于自定义同步行为。

**配置选项：**
- `upstream.repository`: 上游仓库地址
- `upstream.branch`: 上游分支
- `local_branch`: 本地分支
- `sync.auto_merge`: 是否自动合并
- `build.tool`: 构建工具
- `build.command`: 构建命令

## 使用方法

### 自动同步
工作流会在每天凌晨2点自动运行，无需手动干预。

### 手动触发
1. 进入 GitHub 仓库页面
2. 点击 "Actions" 标签
3. 选择相应的工作流
4. 点击 "Run workflow" 按钮

### 强制同步
在手动触发高级同步工作流时，可以选择 "强制同步" 选项，即使没有新的上游更新也会执行同步操作。

## 权限要求

确保仓库具有以下权限：
- `contents: write` - 用于推送代码更新
- `actions: write` - 用于创建工作流运行
- `packages: write` - 用于上传构建产物

## 故障排除

### 同步失败
1. 检查上游仓库是否可访问
2. 确认本地分支存在
3. 检查是否有合并冲突

### 构建失败
1. 检查 Maven 配置
2. 确认 Java 版本兼容性
3. 查看构建日志获取详细错误信息

## 注意事项

- 工作流使用 `GITHUB_TOKEN` 进行身份验证
- 构建产物会保留7天
- 自动发布版本仅在 main 分支上创建
- 建议定期检查工作流运行状态 